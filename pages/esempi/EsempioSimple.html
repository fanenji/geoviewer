<!DOCTYPE HTML>

<html> 
    <head> 
        <title>Esempio Mappa Simple</title> 

		<!-- 
			<script type="text/javascript" src="https://getfirebug.com/firebug-lite.js"></script> 
		-->
		<!-- librerie js -->
        <script src="http://maps.google.com/maps/api/js?sensor=false&v=3.2&language=it"></script>
        <script src="/cartowebNet2/lib/OL/OpenLayers.js" type="text/javascript"></script>
		<!-- jQuery -->
        <script src="/cartowebNet2/lib/jQuery/jquery-1.7.js"></script>
		<!-- libreria cwn2 -->
		<script src="/cartowebNet2/lib/Cwn2/cwn2-noext-debug.js"></script>
        <link rel="stylesheet" type="text/css" href="/cartowebNet2/stili/default/base.css" />


	</head>
	<body>


		<!-- div contenente la mappa -->
		<div id="cwn2_map" style="position: absolute;width: 600px;height: 400px"></div>


		<!-- script contenente le feature da visualizzare in formato GeoJSON -->
		<script>

			$(function(){


                var config = {
                   "_id": "EsempioSimple",
                   "_rev": "13-a3c4204ad540ead78e356ed886fbc7df",
                   "descrizione": "Esempio Simple",
                   "application": {
                       "id": 1,
                       "name": "Esempio Simple",
                       "codRepertorio": "03",
                       "mapOptions": {
                           "restrictedExtent": "830036.283895,5402959.60361,1123018.973727,5597635.329038",
                           "olControls": [
                               {
                                   "name": "LayerSwitcher2"
                               },
                               {
                                   "name": "Zoom"
                               }
                           ]
                       },
                       "layout": {
                           "type": "simple",
                           "toolbar": null
                       }
                   },
                   "baseLayers": [
                       {
                           "id": 5,
                           "idAppl": 1,
                           "idBaseLayer": 1,
                           "type": "no_base",
                           "name": "sfondo_bianco",
                           "minZoomLevel": 0,
                           "maxZoomLevel": 0,
                           "projection": null,
                           "legend": {
                               "label": "Sfondo Bianco",
                               "icon": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/legend/bianco.gif",
                               "popUpUrl": null,
                               "popUpWidth": 0,
                               "popUpHeight": 0
                           },
                           "visible": false
                       },
                       {
                           "id": 1,
                           "idAppl": 1,
                           "idBaseLayer": 3,
                           "type": "google_roadmap",
                           "name": "Google_Stradario",
                           "minZoomLevel": 8,
                           "maxZoomLevel": 18,
                           "projection": null,
                           "legend": {
                               "label": "Google Stradario",
                               "icon": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/legend/google_stradario.png",
                               "popUpUrl": null,
                               "popUpWidth": 0,
                               "popUpHeight": 0
                           },
                           "visible": false
                       },
                       {
                           "id": 6,
                           "idAppl": 1,
                           "idBaseLayer": 2,
                           "type": "google_satellite",
                           "name": "Google_Satellite",
                           "minZoomLevel": 8,
                           "maxZoomLevel": 18,
                           "projection": null,
                           "legend": {
                               "label": "Google Satellite",
                               "icon": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/legend/google_satellite.png",
                               "popUpUrl": null,
                               "popUpWidth": 0,
                               "popUpHeight": 0
                           },
                           "visible": true
                       }
                   ],
                   "layers": [
                       {
                           "id": 1,
                           "idMap": 56,
                           "type": "WMS",
                           "name": "L1",
                           "visible": true,
                           "projection": "EPSG:3003",
                           "attribution": null,
                           "minScale": 0,
                           "maxScale": 0,
                           "opacity": 0.5,
                           "legend": {
                               "label": "Province",
                               "icon": "http://dcarto3.datasiel.net/mapfiles/repertoriocartografico/CONFINI/legenda/L1.png",
                               "popUpUrl": null,
                               "popUpWidth": 0,
                               "popUpHeight": 0
                           },
                           "classes": [
                               {
                                   "id": 1000,
                                   "idLayer": 1,
                                   "numClass": 0,
                                   "filter": null,
                                   "legendLabel": "Classe Base",
                                   "legendIcon": null,
                                   "styleMaps": [
                                       {
                                           "id": 1,
                                           "idLayer": 1,
                                           "idClass": 1000,
                                           "renderIntent": null,
                                           "style": {
                                               "fillColor": "100",
                                               "fillOpacity": 1,
                                               "strokeColor": "003",
                                               "strokeOpacity": 1,
                                               "strokeWidth": 2,
                                               "strokeLinecap": null,
                                               "strokeDashstyle": null,
                                               "pointRadius": 0,
                                               "externalGraphic": null,
                                               "graphicWidth": 0,
                                               "graphicHeight": 0,
                                               "graphicOpacity": 1,
                                               "graphicXOffset": 0,
                                               "graphicYOffset": 0,
                                               "rotation": 0,
                                               "graphicName": null,
                                               "cursor": null,
                                               "display": null
                                           }
                                       }
                                   ]
                               }
                           ],
                           "wmsParams": {
                               "url": "http://dcarto3.datasiel.net/mapserver/mapserv.exe?MAP=E:/progetti/mapfiles/repertoriocartografico/CONFINI/56.map&",
                               "name": "L1",
                               "transparent": true
                           }
                       },
                       {
                           "type": "GeoJSON",
                           "name": "Prova",
                           "projection": "EPSG:4326",
                           "visible": true,
                           "url": null,
                           "infoOptions": {
                               "infoPopUp": "default",
                               "infoLabelAttr": "label",
                               "idAttr": "ID",
                               "infoUrl": "http://parodixp2.datasiel.net/pippo.html?id=${ID}",
                               "infoTarget": "_blank"
                           },
                           "legend": {
                               "label": "Prova",
                               "icon": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/icons/events/alien.png"
                           },
                           "classes": [
                               {
                                   "legendLabel": "Classe Base",
                                   "legendIcon": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/icons/events/alien.png",
                                   "styleMaps": [
                                       {
                                           "renderIntent": "default",
                                           "style": {
                                               "fillColor": null,
                                               "fillOpacity": 0,
                                               "strokeColor": null,
                                               "strokeOpacity": 0,
                                               "strokeWidth": 0,
                                               "strokeLinecap": null,
                                               "strokeDashstyle": null,
                                               "pointRadius": 0,
                                               "externalGraphic": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/icons/events/alien.png",
                                               "graphicWidth": 32,
                                               "graphicHeight": 37,
                                               "graphicOpacity": 1,
                                               "graphicXOffset": -16,
                                               "graphicYOffset": -37,
                                               "rotation": 0,
                                               "graphicName": null,
                                               "cursor": "pointer",
                                               "display": null
                                           }
                                       },
                                       {
                                           "renderIntent": "hover",
                                           "style": {
                                               "fillColor": null,
                                               "fillOpacity": 0,
                                               "strokeColor": null,
                                               "strokeOpacity": 0,
                                               "strokeWidth": 0,
                                               "strokeLinecap": null,
                                               "strokeDashstyle": null,
                                               "pointRadius": 0,
                                               "externalGraphic": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/icons/events/alien_h.png",
                                               "graphicWidth": 32,
                                               "graphicHeight": 37,
                                               "graphicOpacity": 1,
                                               "graphicXOffset": -16,
                                               "graphicYOffset": -37,
                                               "rotation": 0,
                                               "graphicName": null,
                                               "cursor": "pointer",
                                               "display": null
                                           }
                                       },
                                       {
                                           "renderIntent": "select",
                                           "style": {
                                               "fillColor": null,
                                               "fillOpacity": 0,
                                               "strokeColor": null,
                                               "strokeOpacity": 0,
                                               "strokeWidth": 0,
                                               "strokeLinecap": null,
                                               "strokeDashstyle": null,
                                               "pointRadius": 0,
                                               "externalGraphic": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/icons/events/alien_s.png",
                                               "graphicWidth": 32,
                                               "graphicHeight": 37,
                                               "graphicOpacity": 1,
                                               "graphicXOffset": -16,
                                               "graphicYOffset": -37,
                                               "rotation": 0,
                                               "graphicName": null,
                                               "cursor": "pointer",
                                               "display": null
                                           }
                                       }
                                   ]
                               }
                           ]
                       }
                   ]
                };

				var features = { "type": "FeatureCollection",
				  "features": [
					    { "type": "Feature",
					      "geometry": {"type": "Point", "coordinates": [8.0, 44.5]},
					      	"properties": {
						  		"infoPopUp": "<a href=http://dcarto3.datasiel.net?contentId=1 target = '_blank'>museo 1</a><br><br>Prova 1 ",
							  	"label": "Prova 1 "
							}
					    },
					    { "type": "Feature",
					      "geometry": {"type": "Point", "coordinates": [9.0, 44.5]},
					      	"properties": {
						  		"infoPopUp": "<a href=http://dcarto3.datasiel.net?contentId=1 target = '_blank'>museo 2</a><br><br>Prova 2 ",
							  	"label": "Prova 2"
							}
					    }
				     ]
				   };

				// funzione di callback richiamata alla fine della inizializzazione della applicazione
				var loadFeatures = function(app) {
					
					var layerName = 'Prova';
					var zoom = true;
					
					// config
					var config = {
						layerName: 'Prova',
						features: features,
						url: null,
						"filter": {
							"text": null,
							"formar": null
						},
						"options": {
							"zoom": true,
							"clean": true
						}
					};
					
					// Caricamento tramite json
                    app.loadFeatures(config);

					// config
					var config = {
						layerName: 'Prova',
						features: null,
						url: "http://dcarto3.datasiel.net:5984/cwn2_dati/provaGeoJSON",
						"filter": {
							"text": null,
							"formar": null
						},
						"options": {
							"zoom": true,
							"clean": false
						}
					};
					
					// Caricamento tramite url (non faccio la clean)
                    app.loadFeatures(config);
					
				};


				// inizializzo la applicazione
				var initConfig = {
//					appConfig: 'http://dcarto3.datasiel.net:5984/cwn2_config/EsempioSimple',
					appConfig: config,
					divID: "cwn2_map",
					callBack: loadFeatures,
					debug:true
				};

                var app = new CWN2.Application(initConfig);
			});
			   
		</script>




	</body>
</html>
