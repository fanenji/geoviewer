<!DOCTYPE HTML>

<html> 
    <head>

        <title>Esempio Cluster</title>

		<!-- librerie js -->
		<!-- 
			<script type="text/javascript" src="https://getfirebug.com/firebug-lite.js"></script> 
		-->
        <script src="http://maps.google.com/maps/api/js?sensor=false&v=3.2&language=it"></script>
        <script src="/cartowebNet2/lib/OL/OpenLayers.js" type="text/javascript"></script>
		<!-- proj4js -->
		<script src='/cartowebNet2/lib/proj4js/lib/proj4js-min.js'></script>
		<!-- jQuery -->
        <script src="/cartowebNet2/lib/jQuery/jquery-1.7.min.js"></script> 
		<!-- ExtJs -->
        <script src="/cartowebNet2/lib/ExtJs/ext-all-full.js"></script>
        <link rel="stylesheet" type="text/css" href="/cartowebNet2/lib/ExtJs/docs/resources/css/ext-all.css" /> 
		<!-- GeoExt -->
		<script src="/cartowebNet2/lib/GeoExt/script/GeoExt.js"></script>
		<!-- CWN2 -->
		<script src="/cartowebNet2/lib/Cwn2/cwn2-debug.js"></script>
        <link rel="stylesheet" type="text/css" href="/cartowebNet2/stili/default/base.css" /> 



	</head>
	<body>

		<br><br>
		<div id="mappanel"></div>
		<!-- codice js della applicazione -->

		<script>
			
			Ext.onReady(function() {
			
			    Ext.QuickTips.init();

                var config = {
                   "_id": "EsempioCluster",
                   "_rev": "6-8786df71f667384e904f4fece730a4e5",
                   "descrizione": "Esempio Cluster",
                   "application": {
                       "id": 1,
                       "name": "Cluster",
                       "mapOptions": {
                           "restrictedExtent": "830036.283895,5402959.60361,1123018.973727,5597635.329038"
                       },
                       "layout": {
                           "id": 1,
                           "type": "viewport",
                           "title": "Mappa dei Reati",
                           "language": "it",
                           "statusBar": true,
                           "extRequired": true,
                           "width": 1000,
                           "height": 600,
                           "legend": {
                               "type": "simple",
                               "position": "east",
                               "collapsed": false
                           },
                           "widgets": [
                               {
                                   "id": 1,
                                   "type": "widget",
                                   "name": "Scale"
                               },
                               {
                                   "id": 2,
                                   "type": "widget",
                                   "name": "CoordinateReadOut"
                               }
                           ],
                           "toolbar": {
                               "id": 1,
                               "name": "ToolBar Prova su EULERO",
                               "itemGroups": [
                                   {
                                       "name": "navigazione",
                                       "items": [
                                           {
                                               "type": "button",
                                               "name": "pan",
                                               "options": {
                                               }
                                           },
                                           {
                                               "type": "button",
                                               "name": "zoomin",
                                               "options": {
                                               }
                                           },
                                           {
                                               "type": "button",
                                               "name": "zoomout",
                                               "options": {
                                               }
                                           },
                                           {
                                               "type": "button",
                                               "name": "fitall",
                                               "options": {
                                               }
                                           },
                                           {
                                               "type": "button",
                                               "name": "zoomprevious",
                                               "options": {
                                               }
                                           },
                                           {
                                               "type": "button",
                                               "name": "zoomnext",
                                               "options": {
                                               }
                                           }
                                       ]
                                   },
                                   {
                                       "name": "misurazioni",
                                       "items": [
                                           {
                                               "type": "button",
                                               "name": "measureline",
                                               "options": {
                                               }
                                           },
                                           {
                                               "type": "button",
                                               "name": "measurearea",
                                               "options": {
                                               }
                                           }
                                       ]
                                   },
                                   {
                                       "name": "avanzate",
                                       "items": [
                                           {
                                               "type": "button",
                                               "name": "transparency",
                                               "options": {
                                               }
                                           },
                                           {
                                               "type": "button",
                                               "name": "loadlayers",
                                               "options": {
                                                   "getLayersConfigServiceUrl": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/services/configuration/getLayersConfig.ashx?idLayers=",
                                                   "getCanaliTematiciServiceUrl": "http://parodis-dts-pc.datasiel.net/cartowebnet2/services/Configuration/getCanaliTematiciTree.ashx?idApp=",
                                                   "panels": "canali"
                                               }
                                           },
                                           {
                                               "type": "button",
                                               "name": "removelayers",
                                               "options": {
                                               }
                                           },
                                           {
                                               "type": "button",
                                               "name": "find",
                                               "options": {
                                                   "addressGeocodeServiceUrl": "/CartoWebNet2/services/proxy/googleProxyServer.asp?ll=44,8.5&spn=1,1.5&hl=it&gl=it&sensor=false",
                                                   "flagLimitaTerritorioLigure": "true",
                                                   "panels": "indirizzo,toponimo",
                                                   "toponimiServiceUrl": "/CartoWebNet2/services/SrvToponimi/getToponimi.ashx"
                                               }
                                           }
                                       ]
                                   }
                               ]
                           }
                       }
                   },
                   "baseLayers": [
                       {
                           "id": 1,
                           "idAppl": 1,
                           "idBaseLayer": 3,
                           "type": "google_roadmap",
                           "name": "Google_Stradario",
                           "minZoomLevel": 9,
                           "maxZoomLevel": 20,
                           "projection": null,
                           "legend": {
                               "label": "Google Stradario",
                               "icon": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/legend/google_stradario.png",
                               "popUpUrl": null,
                               "popUpWidth": 0,
                               "popUpHeight": 0
                           },
                           "visible": false
                       },
                       {
                           "id": 6,
                           "idAppl": 1,
                           "idBaseLayer": 2,
                           "type": "google_satellite",
                           "name": "Google_Satellite",
                           "minZoomLevel": 9,
                           "maxZoomLevel": 20,
                           "projection": null,
                           "legend": {
                               "label": "Google Satellite",
                               "icon": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/legend/google_satellite.png",
                               "popUpUrl": null,
                               "popUpWidth": 0,
                               "popUpHeight": 0
                           },
                           "visible": true
                       }
                   ],
                   "layers": [
                       {
                           "type": "GeoJSON",
                           "name": "ALBERGI_GeoJSON",
                           "projection": "EPSG:4326",
                           "visible": true,
                           "strategies": [
                               {
                                   "name": "BBOX"
                               },
                               {
                                   "name": "Cluster",
                                   "options": {
                                       "distance": 25,
                                       "threshold": 1
                                   }
                               }
                           ],
                           "url": "http://dcarto3.datasiel.net/MapServer/6.0/mapserv.exe?MAP=E:\\progetti\\mapfiles\\test\\test.map&SERVICE=WFS&VERSION=1.0.0&REQUEST=getfeature&TYPENAME=ALBERGHI&OUTPUTFORMAT=GeoJSON",
                           "classes": [
                           {
                                   "id": 1000,
                                   "idLayer": 1,
                                   "numClass": 0,
                                   "filter": null,
                                   "legendLabel": "ALBERGI GeoJSON",
                                   "legendIcon": null,
                                   "styleMaps": [
                                       {
                                           "renderIntent": "default",
                                           "style": {
                                               "fillColor": null,
                                               "fillOpacity": 0,
                                               "strokeColor": null,
                                               "strokeOpacity": 0,
                                               "strokeWidth": 0,
                                               "strokeLinecap": null,
                                               "strokeDashstyle": null,
                                               "pointRadius": 0,
                                               "externalGraphic": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/icons/restaurants-bars/hotel_0star.png",
                                               "graphicWidth": 32,
                                               "graphicHeight": 37,
                                               "graphicOpacity": 1,
                                               "graphicXOffset": -16,
                                               "graphicYOffset": -37,
                                               "rotation": 0,
                                               "graphicName": null,
                                               "cursor": "pointer",
                                               "display": null
                                           }
                                       }
                                   ]
                               }

                           ],
                           "infoOptions": {
                               "infoPopUp": "default",
                               "infoLabelAttr": "DENOMINAZIONE",
                               "idAttr": "gid",
                               "infoUrl": "javascript:alert('ciao');"
                           },
                           "legend": {
                               "label": "Alberghi",
                               "icon": "http://parodis-dts-pc.datasiel.net/CartoWebNet2/img/icons/restaurants-bars/hotel_0star.png"
                           }
                       }
                   ]
                };

				var initConfig = {
					appConfig: config,
					divID: "mappanel",
					callBack: null,
                    proxy: "/CartoWebNet2/services/proxy/proxy.ashx?url=",
					debug:true
				};
                var app = new CWN2.Application(initConfig);
			
			});			
		</script> 

	</body>
</html>
